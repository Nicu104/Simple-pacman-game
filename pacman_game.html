<!DOCTYPE html>
<html>
<head>
	<title>PacMan</title>
	<style type="text/css">
		*{
			margin: 0;
			padding: 0;
		}
		.row{
			line-height: 0;
		}
		.wall{
			background-color: blue;
			height: 40px;
			width: 40px;
			display: inline-block;
		}
		.sushi{
			background-color: white;
			height: 40px;
			width: 40px;
			display: inline-block;
			background-image: url('img/sushi.png');
			background-size: contain;
		}
		.blank{
			background-color: white;
			height: 40px;
			width: 40px;
			display: inline-block;
		}
		.door{
			background-color: white;
			height: 40px;
			width: 40px;
			display: inline-block;
			background-image: url('img/door.jpg');
			background-size: contain;
		}
		.door{
			background-color: white;
			height: 40px;
			width: 40px;
			display: inline-block;
			background-image: url('img/door.jpg');
			background-size: contain;
		}
		#ninjaman{
			background-color: white;
			height: 40px;
			width: 40px;
			display:  inline-block;
			background-image: url('img/ninja.gif');
			background-size: contain;
			position: absolute;
			top: 40px;
			left: 40px;
		}
		#phantom1{
			background-color: white;
			height: 40px;
			width: 40px;
			display:  inline-block;
			background-image: url('img/red.gif');
			background-size: contain;
			position: absolute;
			top: 480px;
			left: 600px;
		}
		#phantom2{
			background-color: white;
			height: 40px;
			width: 40px;
			display:  inline-block;
			background-image: url('img/pinky.gif');
			background-size: contain;
			position: absolute;
			top: 480px;
			left: 760px;
		}
		#phantom3{
			background-color: white;
			height: 40px;
			width: 40px;
			display:  inline-block;
			background-image: url('img/bluey.gif');
			background-size: contain;
			position: absolute;
			top: 480px;
			left: 800px;
		}

	</style>
</head>
<body>
	<div id='world'>
		
	</div>
	<div id='ninjaman'></div>
	<div id='phantom1'></div>
	<div id='phantom2'></div>
	<div id='phantom3'></div>

</body>
<script type="text/javascript">
	

	var world = [
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
		[1, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1],
		[1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1],
		[1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1],
		[1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1],
		[1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1],
		[1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1],
		[1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1],
		[1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1],
		[1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1],
		[1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1],
		[1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1],
		[1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1],
		[1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 2, 2, 2, 2, 2, 2, 1],
		[3, 2, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 3], //line 14
		[1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 1, 2, 2, 2, 2, 2, 2, 2, 1],
		[1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1],
		[1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1],
		[1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1],
		[1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 2, 2, 2, 2, 2, 2, 1],
		[1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1],
		[1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1],
		[1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1],
		[1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 1],
		[1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1],
		[1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1],
		[1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1],
		[1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1],
		[1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1],
		[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1] ];

	var topValue = 1, leftValue = 1, direction = "ninja.gif", goTo = "", ninjaLife = 3;
	var score = 0, empty = true;
	var audioEndGame = new Audio('PacManGameOver.mp3');
	var phantom1Top = 12, phantom1Left = 15, phantom1Direction = 'left';
	var phantom2Top = 12, phantom2Left = 19, phantom2Direction = 'left';
	var phantom3Top = 12, phantom3Left = 20, phantom3Direction = 'right';


	var worldDict = {
		0: 'blank',
		1: 'wall',
		2: 'sushi',
		3: 'door'
	}
	drawWorld();
	function drawWorld(){
		if(ninjaLife == 0){
			// getElementById('myAudio').play();
			new Audio('PacManGameOver.mp3').play()
			alert("sorry you lost\n your score is " + score);
			score = 0;
			ninjaLife = 3;
			empty = true;
			createGame();

		}
		// empty = true;
		output = '';

		for (var row = 0; row < world.length; row++){
			output += "<div class = 'row'>";
			for (var i = 0; i < world[row].length; i++) {
				output += "<div class='"+worldDict[world[row][i]]+"'></div>";	

				if(world[row][i] == 2 ){
					empty = false;
				}
			}
			output += "</div>";
		}
		document.getElementById('world').innerHTML = output;
		if (empty){
			createGame();
		}
	}
	
	document.onkeydown = function(e){
		console.log(e);


		if (e.keyCode == 37){ // Left
			goTo = "left";
		}
		else if (e.keyCode == 40 ){ // Down
			goTo = "down";
		}
		else if (e.keyCode == 38 ){// Up
			goTo = "up";
		}
		else if (e.keyCode == 39 ){		//Right
			goTo = "right";
		} 
	}

	function update(){

		if (goTo == "left" && leftValue > 0){ // Left
			if (world[topValue][leftValue-1] != 1){
				leftValue = leftValue-1;
				direction = "ninjaLeft.gif";
				if (leftValue <= 0 && topValue == 14){
					leftValue = world[topValue].length - 1; 
				}
			}
		}
		else if (goTo == "down" && topValue < world.length - 1){ // Down
			if (world[topValue+1][leftValue] != 1) {
				topValue = topValue + 1;
				direction = "ninjaDown.gif";
			}
		}
		else if (goTo == "up" && topValue > 0){// Up
			if (world[topValue-1][leftValue] != 1) {
				topValue = topValue - 1;
				direction = "ninjaUp.gif"
			}
		}
		else if (goTo == "right" && leftValue < world[topValue].length - 1){ // Right
			if (world[topValue][leftValue+1] != 1) {
				leftValue = leftValue + 1;
				direction = "ninja.gif";
				if (leftValue >= world[topValue].length - 1 && topValue == 14){
					leftValue = 0;
				}
			}
		} 

	if (world[topValue][leftValue] == 2) {
				score += 10;
				console.log(score);
			}
		if(world[topValue][leftValue] != 3){
			world[topValue][leftValue] = 0;
		}

		var ninja = document.getElementById('ninjaman');
		ninja.style.left = leftValue*40 + 'px';
		ninja.style.top = topValue*40 + 'px';
		ninja.style.backgroundImage = "url('img/"+direction+"')";
		drawWorld();
	}

	function createGame(){
		// leftValue+=1;
		// update();
		if(empty){
			window.alert('you have reached the end of the game\n here is a new one');
			for(var i = 0; i < world.length; i++){
				for(var j = 0; j < world[i].length; j++){
					if (world[i][j] == 0){
						world[i][j] = 2;
					}
				}
			}
			drawWorld();
		}
	}

	function phantomChangeDirection(){
		var dir = Math.random() * 4;
		console.log(Math.floor(dir));
		dir = Math.floor(dir);
		switch(dir){
			case 0:
				console.log(dir, ' : left');
				return "left";
			case 1:
				console.log(dir, ' : right');
				return "right";
			case 2:
				console.log(dir, ' : down');
				return "down";
			case 3:
				console.log(dir, ' : up');
				return "up";
		}

	}

	function movePhantom1(){
		console.log("move phantom 1", phantom1Direction)
		if (phantom1Direction == "left"){ // Left
			if (world[phantom1Top][phantom1Left - 1] != 1){
				phantom1Left -= 1;
			}
			else{
				phantom1Direction = phantomChangeDirection();
			}
		}
		else if (phantom1Direction == "down"){ // Down
			if (world[phantom1Top + 1][phantom1Left] != 1) {
				phantom1Top += 1;
			}
			else{
				phantom1Direction = phantomChangeDirection();
			} 
		}
		else if (phantom1Direction == "up"){// Up
			if (world[phantom1Top - 1][phantom1Left] != 1) {
				phantom1Top -= 1;
			}
			else{
				phantom1Direction = phantomChangeDirection();
			}
		}
		else if (phantom1Direction == "right"){ // Right
			if (world[phantom1Top][phantom1Left + 1] != 1) {
				phantom1Left += 1;
			}
			else{
				phantom1Direction = phantomChangeDirection();
			}
		} 

		if(topValue == phantom1Top && leftValue == phantom1Left){
			ninjaLife -= 1;
		}

		var ph1 = document.getElementById('phantom1');
		ph1.style.left = phantom1Left*40 + 'px';
		ph1.style.top = phantom1Top*40 + 'px';

	}

	function movePhantom2(){
		console.log("move phantom 2", phantom2Direction)
		if (phantom2Direction == "left"){ // Left
			if (world[phantom2Top][phantom2Left - 1] != 1){
				phantom2Left -= 1;
			}
			else{
				phantom2Direction = phantomChangeDirection();
			}
		}
		else if (phantom2Direction == "down"){ // Down
			if (world[phantom2Top + 1][phantom2Left] != 1) {
				phantom2Top += 1;
			}
			else{
				phantom2Direction = phantomChangeDirection();
			} 
		}
		else if (phantom2Direction == "up"){// Up
			if (world[phantom2Top - 1][phantom2Left] != 1) {
				phantom2Top -= 1;
			}
			else{
				phantom2Direction = phantomChangeDirection();
			}
		}
		else if (phantom2Direction == "right"){ // Right
			if (world[phantom2Top][phantom2Left + 1] != 1) {
				phantom2Left += 1;
			}
			else{
				phantom2Direction = phantomChangeDirection();
			}
		} 

		if(topValue == phantom2Top && leftValue == phantom2Left){
			ninjaLife -= 1;
		}
		var ph2 = document.getElementById('phantom2');
		ph2.style.left = phantom2Left*40 + 'px';
		ph2.style.top = phantom2Top*40 + 'px';

	}

	function movePhantom3(){
		// phantom3Direction = phantomChangeDirection();
		console.log("move phantom 3", phantom3Direction)
		if (phantom3Direction == "left"){ // Left
			if (world[phantom3Top][phantom3Left - 1] != 1){
				phantom3Left -= 1;
			}
			else{
				phantom3Direction = phantomChangeDirection();
			}
		}
		else if (phantom3Direction == "down"){ // Down
			if (world[phantom3Top + 1][phantom3Left] != 1) {
				phantom3Top += 1;
			}
			else{
				phantom3Direction = phantomChangeDirection();
			} 
		}
		else if (phantom3Direction == "up"){// Up
			if (world[phantom3Top - 1][phantom3Left] != 1) {
				phantom3Top -= 1;
			}
			else{
				phantom3Direction = phantomChangeDirection();
			}
		}
		else if (phantom3Direction == "right"){ // Right
			if (world[phantom3Top][phantom3Left + 1] != 1) {
				phantom3Left += 1;
			}
			else{
				phantom3Direction = phantomChangeDirection();
			}
		} 

		if(topValue == phantom3Top && leftValue == phantom3Left){
			ninjaLife -= 1;
		}

		var ph3 = document.getElementById('phantom3');

		ph3.style.left = phantom3Left*40 + 'px';
		ph3.style.top = phantom3Top*40 + 'px';

	}


	setInterval(update, 150);
	setInterval(movePhantom1, 200);
	setInterval(movePhantom2, 200);
	setInterval(movePhantom3, 200);

</script>
</html>